<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSONåœ§ç¸®/æ•´å½¢ãƒ„ãƒ¼ãƒ« - Develop Tools</title>
    <link rel="stylesheet" href="../common/common.css">
    <link rel="stylesheet" href="style.css">
    <script src="../common/utils.js"></script>
</head>
<body>
    <div class="container">        
        <h1>JSONåœ§ç¸® / æ•´å½¢ãƒ„ãƒ¼ãƒ«</h1>
        
        <section>
            <h2>JSONã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:</h2>
            <textarea id="inputText" placeholder="JSONæ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>
            <div class="button-group">
                <button class="btn btn-primary" onclick="compressJson()">ğŸ—œï¸ JSONåœ§ç¸®ï¼ˆ1è¡ŒåŒ–ï¼‰</button>
                <button class="btn btn-primary" onclick="formatJson()">ğŸ“‹ JSONæ•´å½¢</button>
                <button class="btn btn-secondary" onclick="clearText('inputText,outputText')">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
            </div>
        </section>

        <section>
            <h2>çµæœ:</h2>
            <textarea id="outputText" readonly placeholder="çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™..."></textarea>
            <div class="button-group">
                <button class="btn btn-copy" onclick="copyToClipboard('outputText')">ğŸ“‹ çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
            </div>
        </section>
    </div>

    <script src="../common/backToHome.js"></script>
    <script>
        const inputText = document.getElementById('inputText');
        const outputText = document.getElementById('outputText');

        // JSONåœ§ç¸®ï¼ˆ1è¡ŒåŒ–ï¼‰
        function compressJson() {
            const input = inputText.value.trim();
            if (!input) {
                showErrorMessage('JSONã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            try {
                // ã¾ãšJSONã¨ã—ã¦æœ‰åŠ¹ã‹ãƒã‚§ãƒƒã‚¯
                JSON.parse(input);                
                let compressed = input
                    .replace(/\s+/g, '') // å…¨ã¦ã®ç©ºç™½æ–‡å­—ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã€ã‚¿ãƒ–ã€æ”¹è¡Œï¼‰ã‚’å‰Šé™¤
                    .replace(/\\n/g, '') // \n ã‚’å‰Šé™¤
                    .replace(/\\\\/g, '\\'); // \\ ã‚’ \ ã«å¤‰æ›
                outputText.value = compressed;
                showSuccessMessage('JSONåœ§ç¸®ãŒå®Œäº†ã—ã¾ã—ãŸï¼');
            } catch (error) {
                try {
                    let compressed = input
                        .replace(/\s+/g, '')
                        .replace(/\\n/g, '')
                        .replace(/\\\\/g, '\\');
                    
                    outputText.value = compressed;
                    showSuccessMessage('æ–‡å­—åˆ—åœ§ç¸®ãŒå®Œäº†ã—ã¾ã—ãŸï¼ˆJSONã¨ã—ã¦ç„¡åŠ¹ãªå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼‰');
                } catch (err) {
                    outputText.value = 'ã‚¨ãƒ©ãƒ¼: åœ§ç¸®ã«å¤±æ•—ã—ã¾ã—ãŸ';
                    showErrorMessage('åœ§ç¸®ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
            }
        }

        // JSONæ•´å½¢
        function formatJson() {
            const input = inputText.value.trim();
            if (!input) {
                showErrorMessage('JSONã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            try {
                // JSONã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦æ•´å½¢
                const parsed = JSON.parse(input);
                const formatted = JSON.stringify(parsed, null, 2);
                outputText.value = formatted;
                showSuccessMessage('JSONæ•´å½¢ãŒå®Œäº†ã—ã¾ã—ãŸï¼');
            } catch (error) {
                outputText.value = 'ã‚¨ãƒ©ãƒ¼: ç„¡åŠ¹ãªJSONå½¢å¼ã§ã™';
                showErrorMessage('ç„¡åŠ¹ãªJSONå½¢å¼ã§ã™');
            }
        }
    </script>
</body>
</html> 